# Generated by Django 4.2 on 2023-06-22 19:29

from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):
    dependencies = [
        ("search", "0049_experiment_source_type"),
    ]

    operations = [
        migrations.AddField(
            model_name="experiment",
            name="default_analysis",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="default_for",
                to="search.analysis",
            ),
        ),
        migrations.RunSQL(
            """UPDATE search_experiment AS se SET default_analysis_id =
            (SELECT sa.id
            FROM search_analysis as sa
            WHERE sa.experiment_accession_id = se.accession_id
            LIMIT 1)""",
            reverse_sql="",
        ),
    ]
