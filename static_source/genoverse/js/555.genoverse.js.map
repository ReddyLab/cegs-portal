{"version":3,"file":"555.genoverse.js","mappings":"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","sources":["webpack://genoverse/./src/js/plugins/trackControls.js"],"sourcesContent":["import '../../css/trackControls.css';\n\nconst plugin = function () {\n  const jQuery          = this.jQuery;\n  const defaultControls = [\n    jQuery('<a title=\"More info\" class=\"fas fa-question-circle\">').on('click', function () {\n      const track = jQuery(this).data('track');\n\n      let menu = track.prop('menus').filter('.gv-track-info');\n\n      if (!menu.length) {\n        const info = track.prop('info');\n\n        menu = track.prop(\n          'menus',\n          track.prop('menus').add(\n            track.browser.makeMenu({\n              title                                                        : track.name,\n              [typeof info === 'function' ? info.call(track) : info || ''] : '',\n            }).addClass('gv-track-info')\n          )\n        );\n      }\n\n      menu.show().position({ of: track.prop('container'), at: 'center top', my: 'center top', collision: 'none' });\n    }),\n\n    jQuery(`\n      <a class=\"gv-height-toggle\">\n        <i class=\"fas fa-sort\"></i>\n        <i class=\"fas fa-sort-down\"></i>\n        <i class=\"fas fa-sort-up\"></i>\n      </a>\n    `).on({\n      click: function () {\n        const track = jQuery(this).data('track');\n\n        let height;\n\n        if (track.prop('autoHeight', !track.prop('autoHeight'))) {\n          track.prop('heightBeforeToggle', track.prop('height'));\n          height = track.prop('fullVisibleHeight');\n        } else {\n          height = track.prop('heightBeforeToggle') || track.prop('initialHeight');\n        }\n\n        jQuery(this).trigger('toggleState');\n\n        track.controller.resize(height, true);\n      },\n      toggleState: function () { // custom event to set title and change the icon\n        const track      = jQuery(this).data('track');\n        const autoHeight = track.prop('autoHeight');\n        const resizer    = track.prop('resizer');\n\n        this.title = autoHeight ? 'Set track to fixed height' : 'Set track to auto-adjust height';\n\n        jQuery(this)[autoHeight ? 'addClass' : 'removeClass']('gv-auto-height');\n\n        if (resizer) {\n          resizer[autoHeight ? 'hide' : 'show']();\n        }\n      },\n    }),\n  ];\n\n  const remove = jQuery('<a title=\"Remove track\" class=\"far fa-trash-alt\">').on('click', function () {\n    jQuery(this).data('track').remove();\n  });\n\n  const toggle = jQuery(`\n    <a class=\"gv-track-controls-toggle\">\n      <span><i class=\"fas fa-angle-double-left\"></i><i class=\"fas fa-cog\"></i></span>\n      <span><i class=\"fas fa-angle-double-right\"></i></span>\n    </a>\n  `).on('click', function () {\n    jQuery(this).parent().toggleClass('gv-maximized');\n  });\n\n  this.on({\n    afterAddDomElements: function () {\n      let controls = this.prop('controls');\n\n      if (controls === 'off') {\n        return;\n      }\n\n      const defaultConfig = this.prop('defaultConfig');\n      const savedConfig   = this.browser.savedConfig?.[this.prop('id')] || {};\n\n      controls = (controls || []).concat(defaultControls, this.prop('removable') === false ? [] : remove);\n\n      this.trackControls = jQuery('<div class=\"gv-track-controls\">').prependTo(this.container);\n\n      const controlsContainer = jQuery('<div class=\"gv-track-controls-container\">').appendTo(this.trackControls);\n\n      controls.forEach(\n        (control) => {\n          let el;\n\n          if (jQuery.isPlainObject(control) && control.type) {\n            el = jQuery(`<${control.type}>`).data('control', control.name);\n\n            (control.options || []).forEach(\n              option => el.append(`<option value=\"${option.value}\">${option.text}</option>`)\n            );\n          } else if (typeof control === 'string') {\n            el = jQuery(control);\n          } else if (typeof control === 'object' && control.constructor && control instanceof jQuery) {\n            el = control.clone(true);\n          }\n\n          el.data('track', this.track).appendTo(controlsContainer);\n\n          // TODO: other control types\n          if (el.is('select')) {\n            const prop = el.data('control');\n\n            el.find(`option[value=${savedConfig[prop] || defaultConfig[prop] || 'all'}]`).attr('selected', true).end().change(function () {\n              jQuery(this).data('track').setConfig(jQuery(this).data('control'), this.value);\n            });\n          }\n        }\n      );\n\n      this.prop('heightToggler', controlsContainer.children('.gv-height-toggle').trigger('toggleState'));\n\n      const toggler = toggle.clone(true).data('track', this.track).appendTo(this.trackControls);\n\n      toggler.trigger('click');\n\n      this.minLabelHeight = Math.max(this.minLabelHeight, this.trackControls.outerHeight(true) + this.prop('margin'));\n\n      toggler.trigger('click');\n    },\n    afterResize: function () {\n      if (this.trackControls) {\n        this.trackControls[this.prop('height') < this.trackControls.outerHeight(true) ? 'hide' : 'show']();\n      }\n    },\n    afterResetHeight: function () {\n      const heightToggler = this.prop('heightToggler');\n\n      if (this.prop('resizable') === true && heightToggler) {\n        heightToggler[this.prop('autoHeight') ? 'addClass' : 'removeClass']('gv-auto-height');\n        heightToggler.trigger('toggleState');\n      }\n    },\n    afterSetMVC: function () {\n      const heightToggler = this.prop('heightToggler');\n\n      if (heightToggler) {\n        heightToggler.trigger('toggleState')[this.prop('resizable') === true ? 'removeClass' : 'addClass']('gv-hide');\n      }\n    },\n  }, 'tracks');\n};\n\nexport default { trackControls: plugin };\n"],"names":["trackControls","jQuery","this","defaultControls","on","track","data","menu","prop","filter","length","info","add","browser","makeMenu","title","name","call","addClass","show","position","of","at","my","collision","click","height","trigger","controller","resize","toggleState","autoHeight","resizer","remove","toggle","parent","toggleClass","afterAddDomElements","controls","defaultConfig","savedConfig","concat","prependTo","container","controlsContainer","appendTo","forEach","control","el","isPlainObject","type","options","option","append","value","text","constructor","clone","is","find","attr","end","change","setConfig","children","toggler","minLabelHeight","Math","max","outerHeight","afterResize","afterResetHeight","heightToggler","afterSetMVC"],"sourceRoot":""}
